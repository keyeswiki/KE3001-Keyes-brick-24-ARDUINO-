### 项目二十六 按键控制RGB灯

**1.实验说明**

在前面课程中，我们利用旋转编码器计数然后控制两个LED灯。在这一课程中，我们做一个扩展，我们利用代码，计算出按下模块上按键的次数。然后我们将所得数据除以三，所得余数为0 1 2三种。然后通过不同的余数，控制RGB模块上LED显示不同的颜色。

这样，我们就可以通过不断的按下按键，任意调节RGB模块上LED显示不同颜色了（三种颜色）。

**2.实验器材**

- keyes brick 插件RGB模块\*1

- keyes UNO R3开发板\*1

- keyes brick 按键传感器\*1

- 传感器扩展板\*1

- 4P双头XH2.54连接线\*1

- 3P 双头XH2.54连接线\*1

- USB线\*1


**3.接线图**

![](media/image-20251015155501515.png)

**4.测试代码**

![](media/image-20251016162431216.png)

**5.代码说明**

1.![](media/image-20251015155620633.png)；手按下一次传感器上按键后，![](media/image-20251015155646026.png)和![](media/image-20251015155655906.png)数据变为不相等；![](media/image-20251015155708198.png)检测到一次为0，![](media/image-20251015155743604.png)就会加1一次。

2. 当我们没有按下按键时，![](media/image-20251015155708198.png)和![](media/image-20251015155655906.png)数据都为1，按下按键次数![](media/image-20251015155743604.png)不变，按键次数![](media/image-20251015155743604.png)除以3的余数![](media/image-20251015155958098.png)不变，RGB模块上LED显示的颜色也就不变。
3. 当我们长按按键时，![](media/image-20251015155708198.png)和![](media/image-20251015155655906.png)数据都为0，按下按键次数![](media/image-20251015155743604.png)不变，按键次数![](media/image-20251015155743604.png)除以3的余数![](media/image-20251015155958098.png)不变，RGB模块上LED显示的颜色也就不变。
4. 当我们按下一次按键（按下后松开）时，![](media/image-20251015155708198.png)为0，![](media/image-20251015155655906.png)为1，按下按键次数![](media/image-20251015155743604.png)加1，按键次数![](media/image-20251015155743604.png)除以3的余数![](media/image-20251015155958098.png)变化，RGB模块上LED显示的颜色改变一次。

**6.测试结果**

上传测试代码成功，按照接线图接好线，利用USB上电后，打开串口监视器，设置波特率为9600；串口监视器显示![](media/image-20251015155958098.png)数据，不断按下按键，![](media/image-20251015155958098.png)数据在0 1 2中变化。当为![](media/image-20251015155958098.png)为0时，RGB模块上LED显示红色；当![](media/image-20251015155958098.png)1时，RGB模块上LED显示绿色；当![](media/image-20251015155958098.png)为2时，RGB模块上LED显示蓝色。

![](media/image-20251015160519832.png)

